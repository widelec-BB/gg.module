# makefile for GNU make (automatically generated by makemake 28-Mar-13, 22:27:41)
# NOTE: indent with TAB in GNU makefiles!

# MESSAGES #

COMPILE_FILE=printf "\033[K\033[0;33mCompiling \033[1;33m$<\033[0;33m...\033[0m\n"
TARGET_DONE=printf "\033[K\033[0;32mTarget \"$@\" successfully done.\033[0m\n"
MERGING=printf "\033[K\033[1;34mLibrary merging \"$@\"... \033[0m\n"

OS = $(shell uname -s)

NIL = /dev/null 2>&1
ifeq ($(OS),MorphOS)
	NIL = NIL:
endif

# VERSION DEFINES #

VERSION = -D__AMIGADATE__=\"\ \($(shell date "+%d.%m.%Y")\)\ \" -D__COPYRIGHT__=\"©\ $(shell date "+%Y")\ Filip\ \'\widelec\'\ Maryjañski\"

# PROJECT #
# paths are relative to the project directory (current directory during make)

OUTFILE = libgg.a

OUTDIR  = ./
OBJDIR  = ./

PROJECT = $(OUTDIR)$(OUTFILE)

# COMPILER #
CC = ppc-morphos-gcc-11
CWARNS = -Wall -Wno-pointer-sign
CDEFS  = $(VERSION) -D__NOLIBBASE__ -DUSE_INLINE_STDARG
# -D__DEBUG__
CFLAGS = -O3 -noixemul -fno-builtin
CLIBS  =

COMPILE = $(CC) $(TARGET) $(CWARNS) $(CDEFS) $(CFLAGS) $(CLIBS)

# AR #
AR = ppc-morphos-gcc-ar-11
ARPARMS = rs

.PHONY: doc

# target 'all' (default target)
all: $(PROJECT)
	@$(TARGET_DONE)

# target 'compiler' (compile target)
$(OBJDIR)gglib.c.o: gglib.c globaldefines.h ggdefs.h gghandlers.h gglib.h
	@$(COMPILE_FILE)
	@$(COMPILE) -c -o $(OBJDIR)gglib.c.o gglib.c

$(OBJDIR)sha1.c.o: sha1.c globaldefines.h support.h
	@$(COMPILE_FILE)
	@$(COMPILE) -c -o $(OBJDIR)sha1.c.o sha1.c

$(OBJDIR)support.c.o: support.c globaldefines.h support.h
	@$(COMPILE_FILE)
	@$(COMPILE) -c -o $(OBJDIR)support.c.o support.c
	
$(OBJDIR)gghandlers.c.o: gghandlers.c globaldefines.h ggdefs.h support.h gglib.h \
 ggpackets.h gghandlers.h
	@$(COMPILE_FILE)
	@$(COMPILE) -c -o $(OBJDIR)gghandlers.c.o gghandlers.c
	
$(OBJDIR)ggpackets.c.o: ggpackets.c globaldefines.h endianess.h support.h gglib.h \
 ggpackets.h sha1.h ggdefs.h
	@$(COMPILE_FILE)
	@$(COMPILE) -c -o $(OBJDIR)ggpackets.c.o ggpackets.c
	
$(OBJDIR)ggmessage.c.o: ggmessage.c globaldefines.h support.h ggmessage.h
	@$(COMPILE_FILE)
	@$(COMPILE) -c -o $(OBJDIR)ggmessage.c.o ggmessage.c

OBJS = $(OBJDIR)gglib.c.o $(OBJDIR)sha1.c.o $(OBJDIR)support.c.o \
 $(OBJDIR)gghandlers.c.o $(OBJDIR)ggpackets.c.o $(OBJDIR)ggmessage.c.o

# link all file(s)
$(PROJECT): $(OBJS)
	@$(MERGING)
	@$(AR) $(ARPARMS) $@ $(OBJS)

# any other targets

clean:
	@-rm -rf $(PROJECT) >$(NIL)
	@-rm -rf $(OUTDIR)test >$(NIL)
	@-rm -rf $(OBJDIR)*.o >$(NIL)
	@$(TARGET_DONE)

doc:
	@rm -rf doc >$(NIL)
	@robodoc --src ./ --doc ./doc --multidoc --cmode --internal --nodesc --toc --index --html >$(NIL)
	@find ./doc -name "*.html" | xargs sed -i "s/charset=ISO-8859-1/charset=ISO-8859-2/g" 
